# Arclo – Free Report v1 Feature Requirements (Dev Spec)
Owner: Engineering (Replit)
Priority: P0
Goal: Implement a Free Report v1 that generates a clear, shareable SEO diagnosis from:
- Competitor list
- Keyword targets + ranking snapshot
- Technical SEO crawl findings
- Performance / speed signals

The Free Report must be fast, understandable, and designed to lead users to “Next steps” (DIY vs Autopilot vs Managed Site later).

---

## 0) Definition of Done (DoD)
This feature is complete when:
1. A user can enter a website URL and trigger a scan.
2. The system produces a Free Report v1 with the required sections and data fields.
3. The report renders in UI with stable layout, mobile-friendly, no raw dumps.
4. The report can be re-opened by `report_id` and re-rendered without recomputing.
5. The report shows deterministic severity/impact tags and a health score.
6. All report sections are populated OR gracefully show “Not available” states with reasons.
7. A shareable, read-only link exists for the free report (unguessable token).
8. Basic analytics events are emitted for key steps.

---

## 1) User Flow
### Entry
- User lands on `/` (marketing page) and enters a URL.
- Clicks “Run Free SEO Scan”.

### Scan & report creation
- Kick off scan job.
- Show progress UI.
- When complete, route user to `/report/free/:reportId` (read-only view).

### Persistence
- Report is stored in DB and can be reopened.
- If user re-runs scan for same website within a time window, create a new report version.

---

## 2) Routes / Pages
### Frontend
- `GET /scan` (optional; can be implicit from `/`)
- `GET /report/free/:reportId` (Free Report view)
- `GET /report/free/:reportId/share/:shareToken` (Shareable read-only view)

### Backend API
- `POST /api/scan` -> create scan + return scanId
- `GET /api/scan/:scanId/status` -> queued|running|complete|error
- `POST /api/report/free` -> create free report from a completed scan (or do automatically on scan completion)
- `GET /api/report/free/:reportId` -> returns report JSON
- `GET /api/report/free/:reportId/share/:shareToken` -> returns same JSON (read-only)
- `POST /api/report/free/:reportId/share` -> creates share token

---

## 3) Data Sources (Assumed Available)
The user stated these are available now:
- Competitor list
- Keywords to rank for
- Ranking against those keywords
- Technical SEO crawl output
- Speed / performance output

If any upstream service returns partial/empty, the report must still render with fallbacks.

---

## 4) Report Content Requirements (Exact Sections + Order)
The Free Report UI MUST render the following sections in this order:

1) Executive Summary
2) Competitor Landscape
3) Keyword Opportunity & Ranking Snapshot
4) Technical SEO Health
5) Performance & Speed Signals
6) What This Means + Next Steps

No additional sections in v1.

---

## 5) Report JSON Schema (Required Fields)
Store the report in a normalized JSON document.

### Top-level
- `report_id` (string)
- `website_id` (string; can be derived from URL)
- `created_at` (timestamp)
- `source_scan_id` (string)
- `share_tokens` (optional array)
- `report_version` (int)
- `inputs` (urls/domains used)
- `summary` (object)
- `competitors` (array)
- `keywords` (object)
- `technical` (object)
- `performance` (object)
- `next_steps` (object)
- `meta` (object: generation status, missing data reasons)

---

## 6) Section Requirements

### 6.1 Executive Summary (Required)
Purpose: clarity in <30 seconds.

Required fields:
- `summary.health_score` (0–100 integer)
- `summary.top_issues` (array length 3)
- `summary.top_opportunities` (array length 3)
- `summary.estimated_opportunity` (object)
  - `traffic_range_monthly` (min,max ints OR null)
  - `leads_range_monthly` (min,max ints OR null)
  - `revenue_range_monthly` (min,max ints OR null)
  - `confidence` ("low"|"medium"|"high")

Each issue/opportunity item must include:
- `title` (string)
- `explanation` (string, <= 240 chars)
- `severity` ("low"|"medium"|"high")
- `impact` ("traffic"|"conversion"|"both")
- `mapped_section` ("competitors"|"keywords"|"technical"|"performance")

Rules:
- No jargon
- 3 and only 3 issues + 3 opportunities
- Must be deterministic given the inputs (no random wording)

---

### 6.2 Competitor Landscape (Required)
Required fields:
- `competitors.items` array length 3–5 (cap at 5)
Each competitor:
- `domain`
- `visibility_index` (0–100 or relative score)
- `keyword_overlap_count` (int)
- `example_pages` (array up to 2 URLs)
- `notes` (<= 160 chars)

Required insight:
- `competitors.insight` (1 sentence, <= 200 chars)

Fallback:
- If competitors cannot be computed:
  - show empty state with `meta.missing.competitors_reason`

---

### 6.3 Keyword Opportunity & Ranking Snapshot (Required)
Required fields:
- `keywords.targets` array length 10–20
Each target:
- `keyword`
- `intent` ("high_intent"|"informational")
- `volume_range` ({min,max} ints OR null)
- `current_bucket` ("top_3"|"4_10"|"11_30"|"not_ranking")
- `winner_domain` (string OR null)

Aggregate:
- `keywords.bucket_counts` {top_3, 4_10, 11_30, not_ranking} ints
- `keywords.insight` (1 sentence, <= 200 chars)

Rules:
- Cap to 20 targets
- Must include at least 5 high_intent keywords if available
- No exact rank required; use buckets only

Fallback:
- If rank data missing, set `current_bucket = "not_ranking"` and add `meta.missing.rank_reason`

---

### 6.4 Technical SEO Health (Required)
Required grouping: exactly 4 buckets:
1. Indexing & Crawlability
2. Site Structure & Internal Links
3. On-page Basics
4. Errors & Warnings

Required fields:
- `technical.buckets` array length 4
Each bucket:
- `name` (one of the above)
- `status` ("good"|"needs_attention"|"critical")
- `findings` array length 1–3
Each finding:
- `title`
- `detail` (<= 240 chars)
- `severity` ("low"|"medium"|"high")
- `impact` ("traffic"|"conversion"|"both")
- `example_urls` (array up to 3)

Rules:
- Do not show raw crawl tables
- Show representative issues only
- Always show at least 1 finding per bucket if data exists

Fallback:
- If crawl data missing, show 4 buckets with status “needs_attention” and note “Crawl data not available” in meta.

---

### 6.5 Performance & Speed Signals (Required)
Required fields:
- `performance.urls` array length 3–5
Each URL entry:
- `url`
- `lcp_status` ("good"|"needs_work"|"poor")
- `cls_status` ("good"|"needs_work"|"poor")
- `inp_status` ("good"|"needs_work"|"poor")  // or fallback to "not_available"
- `overall` ("good"|"needs_attention"|"critical")

Also required:
- `performance.global_insight` (<= 200 chars)

Rules:
- Use traffic-light statuses, not raw ms numbers (optional to include raw metrics in meta)
- Prefer homepage + top landing pages if available

Fallback:
- If performance data missing, show empty state + reason in meta.

---

### 6.6 What This Means + Next Steps (Required)
Required fields:
- `next_steps.if_do_nothing` array length 2–3
- `next_steps.if_you_fix_this` array length 2–3
- `next_steps.ctas` array length 3 with:
  - `id` ("view_full_report"|"deploy_fixes"|"send_to_dev")
  - `label`
  - `action` ("route"|"modal")
  - `target` (route or modal id)

In v1:
- `view_full_report` can route to signup-gated full report OR be a placeholder link
- `deploy_fixes` should open a placeholder modal (even if billing not built yet) saying “Autopilot coming soon” OR route to existing flow if already implemented
- `send_to_dev` should generate a downloadable/copyable “Implementation Plan” summary (see Section 8)

---

## 7) Scoring & Severity Rules (Deterministic)
Implement a simple scoring algorithm:
- Start at 100
- Subtract penalties:
  - Indexing/crawl critical issues: -20 each (cap -40)
  - Many 4xx/5xx / redirect chains: -10 to -20
  - Poor performance on key pages: -10 to -25
  - Not ranking for high-intent keywords (>= 8 in not_ranking): -10 to -20
- Clamp 0–100

Severity tagging:
- Indexability blockers => high
- Performance poor on homepage/top pages => medium/high
- Missing on-page basics => medium
- Low-impact warnings => low

Must produce consistent results from same inputs.

---

## 8) “Implementation Plan” Output (Free, Shareable)
On the free report page, include a collapsible “Implementation Plan (DIY)” section that:
- Summarizes top 5 prioritized fixes from across sections
- For each fix, provide:
  - What to change
  - Where to change it (URL/template)
  - Expected impact
  - Quick acceptance check

API:
- This can be generated as part of report JSON: `next_steps.implementation_plan[]`
- Support “Copy all” button
- Optional “Print / Download” via browser print stylesheet

---

## 9) Shareable Link Security
Share URLs must be:
- Uuid or random token (unguessable)
- Read-only
- Do not expose private auth data, tokens, or internal IDs beyond reportId

Endpoints:
- `POST /api/report/free/:reportId/share` creates token
- `GET /api/report/free/:reportId/share/:shareToken` fetches report

---

## 10) Error Handling / Partial Data
UI must render each section with one of:
- Normal data view
- “Not available” view with reason string from `meta.missing`

Never show a blank page.

---

## 11) Caching & Performance
- Report generation should run async with job runner.
- UI polls scan status, then fetches report.
- Store report JSON in DB; never regenerate on each view.
- Allow re-run scan to create a new report.

---

## 12) Analytics Events (Required)
Emit events:
- `free_scan_started`
- `free_scan_completed`
- `free_report_viewed`
- `free_report_shared`
- `free_report_cta_clicked` with `{cta_id}`
- `implementation_plan_copied`

---

## 13) QA Acceptance Tests
1. Run scan on a valid domain -> report generated -> renders all sections.
2. Missing competitors -> competitor section shows “not available” reason; rest renders.
3. Share link works without login and shows same report.
4. Health score is stable across refreshes.
5. Mobile layout: hero summary visible and readable; no overflow tables.
6. “Copy all” implementation plan copies expected content.

---