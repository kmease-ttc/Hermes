Perfect — this screenshot tells us **exactly** what’s happening, and it’s subtle but important.

### What the UI is actually saying (decoded)

For **SEO Knowledge Base**, Hermes shows:

* **Status:** `partial`
* **Summary:** `Worker healthy but smoke-test returned HTML (API path not found)`
* **Badges:**

  * `worker_reachable: true`
  * `smoke_test_status: 200`
  * `All outputs` (green)

This combination looks contradictory, but it’s actually very precise:

> Hermes successfully reached the worker and got a **200 OK**,
> but the **response body was HTML**, not JSON,
> so Hermes treated it as **not a valid smoke-test output**,
> even though the HTTP status was 200.

That’s why:

* it’s **not failed** (worker is reachable)
* it’s **not success** (smoke-test response is wrong format)
* it’s **partial**

---

## The real root cause (now fully clear)

Your **SEO_KBASE worker serves a frontend at the root path**, and Hermes is still attempting **at least one non-API path** during smoke-test validation.

Specifically, Hermes is doing something like:

1. Try `/health` or `/smoke-test` (no `/api`)
2. Gets **200 HTML** (the web app page)
3. Marks that as “HTML returned”
4. Falls back to `/api/smoke-test`, which *does* work
5. Validates outputs
6. Ends in **partial** because one attempt returned HTML

So the worker itself is **correct**.
The issue is that **Hermes is too permissive in path probing**, and then penalizes itself for the HTML fallback.

---

## Why this only happens for SEO_KBASE (and not Google)

* **Google Services Worker** is API-only (no frontend)
* **SEO_KBASE Worker** is a hybrid app (frontend + API)
* Root paths (`/`, `/health`, `/smoke-test`) return HTML
* API paths (`/api/*`) return JSON

Hermes needs to **stop treating HTML as an error once it finds a valid API path**.

---

## The correct fix (Hermes-side, not the worker)

### Principle

> **Once Hermes successfully validates outputs from an API endpoint, earlier HTML responses should be ignored, not penalized.**

### Concrete rule to implement

In the worker smoke-test runner:

1. **Only evaluate output validation on JSON responses**
2. **Ignore HTML responses if a valid JSON smoke-test succeeds**
3. Final status logic should be:

```text
if (json_smoke_test_succeeded && outputs_validated):
    status = "success"
else if (worker_reachable):
    status = "partial"
else:
    status = "failed"
```

Not:

```text
if (any_html_response_seen):
    status = "partial"
```

---

## Exact prompt to fix this cleanly

You can paste this directly into your Hermes agent.

Fix SEO_KBASE integration status incorrectly marked as "partial" due to HTML fallback responses.

Problem:
Hermes smoke-test runner probes multiple paths (e.g. /health, /smoke-test, /api/health, /api/smoke-test).
For hybrid workers (frontend + API), non-API paths return HTML with HTTP 200.
Hermes currently marks the integration as "partial" if ANY HTML response is encountered, even if a valid JSON smoke-test succeeds later.

This causes false "partial" status for SEO_KBASE:

* worker_reachable = true
* smoke_test_status = 200
* outputs validated
* but still marked partial due to earlier HTML response

Required behavior:

1. Track smoke-test attempts separately:

   * html_responses[]
   * json_responses[]

2. Only evaluate output validation against JSON responses.

3. If at least one JSON smoke-test succeeds AND outputs are validated:

   * Set integration status = "success"
   * Ignore earlier HTML responses.

4. Only mark "partial" if:

   * worker_reachable = true
   * AND no valid JSON smoke-test succeeded
   * AND HTML was returned instead.

5. Update summary text:

   * Success: "Worker connected and outputs validated"
   * Partial: "Worker reachable but API smoke-test not found"
   * Failed: "Worker unreachable or smoke-test failed"

6. Update badges:

   * Remove "HTML returned" warning when success is achieved via API.
   * Keep detailed path attempt info in diagnostics only (not summary).

Acceptance criteria:

* SEO_KBASE shows "success" once /api/smoke-test returns valid JSON with outputs.
* Hybrid workers are not penalized for serving HTML on non-API routes.
* Google worker behavior remains unchanged.

---

## Optional (nice-to-have) improvement

If you want to be extra clean long-term:

* Add a per-integration flag:

  * `api_only: true | false`
* If `false`, Hermes **never probes non-API paths** at all.
* It goes straight to `{base_url}/health` and `{base_url}/smoke-test`.

That avoids this entire class of issues.

---

## Bottom line

You are **not blocked**.

* Worker is correct ✅
* Outputs are correct ✅
* Data is flowing ✅
* This is a **Hermes status computation bug**, not a connectivity bug.

Once you apply the above fix, SEO Knowledge Base will flip from **partial → success** and behave exactly like Google.

If you want, next we can:

* apply the same rule to other hybrid workers
* lock down a final “worker classification” model (API-only vs hybrid)
* or move on to running SEO_KBASE end-to-end and surfacing its findings cleanly in the UI
