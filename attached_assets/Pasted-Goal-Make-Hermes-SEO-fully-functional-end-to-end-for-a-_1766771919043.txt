Goal
Make Hermes SEO fully functional end-to-end for a single customer (empathyhealthclinic.com). Replace all placeholders with live data from connected services, wire up “Get more data” actions, and generate real insights + suggested changes based on combined signals across workers.

Scope (single tenant for now)

* Hardcode or default DOMAIN = "empathyhealthclinic.com" everywhere in UI/API until multi-tenant exists.
* All dashboard cards, analysis pages, tickets, suggested changes, and knowledge base insights must be powered by real service calls + stored results (not placeholder constants).

1. Inventory current UI placeholders and replace with real data
   Search the codebase for:

* hardcoded numbers: 0, 25, 20, “Good”, “Needs improvement”, “Below average”, empty arrays
* mock data objects, “TODO”, “placeholder”, “sample”, “fake”, “stub”
  For each placeholder found in:
* Dashboard Overview cards
* Compare to Industry Benchmarks section
* Knowledge Base Insights section
* Diagnostic Tickets list
* Keyword Ranking / SERP Tracking
* Technical SEO
  Replace with derived values from stored results populated by actual worker calls.

2. Add a unified “Data Store” layer for fetched results
   Implement a consistent server-side storage for “latest run” per worker + domain:

* Tables (or Drizzle models) like:

  * seo_runs: id, domain, started_at, completed_at, status
  * seo_worker_results: id, run_id, worker_key, domain, created_at, payload_json, summary_json, metrics_json
  * seo_suggestions: id, run_id, domain, created_at, suggestion_type, title, severity, evidence_json, actions_json, status
  * seo_tickets: id, run_id, domain, created_at, title, description, category, priority, owner, impact, evidence_json, status
  * seo_kbase_insights: id, run_id, domain, created_at, title, summary, article_refs_json, actions_json
    Store raw payloads from workers in payload_json, but also extract normalized metrics into metrics_json for fast UI reads.

3. Implement “Run / Get more data” orchestration
   On server:

* Create an endpoint: POST /api/run (domain optional; default empathyhealthclinic.com)
* This triggers sequential or parallel calls to all enabled services:

  * backlinks/authority
  * serp/keyword ranking
  * technical crawler
  * core web vitals
  * competitive intel
  * content validator
  * content decay monitor
  * kbase read/write if enabled
* Persist results into seo_worker_results.
* Return run_id immediately; allow polling GET /api/run/:id

On UI:

* Any “Get more data” button should:

  * call POST /api/run
  * show loading state
  * poll until completed
  * refresh dashboard/analysis pages from stored latest results (GET /api/latest?domain=...)

4. Dashboard: compute real metrics
   Replace each card with computed metrics from worker results:
   Website Traffic

* If you have GA4/Clarity data wired: show sessions for last 7d/30d and WoW delta.
* If not available yet: remove traffic card metrics entirely or label as “Not connected” (no fake numbers).

Technical SEO

* Pages checked: use crawler result count (actual crawled pages in the run)
* Issues found: count of detected issues (broken links, missing titles, duplicate H1, noindex, etc.)
* Also display Total Pages on Site:

  * Use crawler “discovered urls” OR sitemap count OR internal link graph count
  * Show both: “Checked X of Y pages” where Y is total known pages.

Keyword Ranking

* Change to top 100 tracked keywords, not 25:

  * Update worker call to request 100 results (or loop/paginate until 100).
  * UI should reflect “Tracked: 100” (or actual count if fewer).
* In Top 10: computed count of keywords ranking positions 1–10.
* Opportunities: keywords ranking 11–30 (or 11–20) to push into top 10.
* Not ranking: keywords with position > 100 or missing.

Compare to Industry Benchmarks
Fix these calculations; values like Avg Position #0.0 must never happen.

* Avg Position:

  * Must be weighted average across tracked keywords with positions >= 1
  * Clamp to minimum 1.0
  * If no data, show “N/A” not 0
* Conversion Rate and Organic CTR:

  * Pull from GA4/GSC if connected; otherwise show “N/A”
* If you keep percentile bands (P25/P50/P90), ensure the “Your value” is placed correctly, not inverted.
* If benchmarks aren’t actually sourced yet, remove the benchmark bands and show only “Your value” with a note “Benchmarks not loaded”.

5. Suggested Changes: generate from combined signals (the missing list you want)
   Implement a rules engine that reads worker results and emits suggestions. This is the critical “make it useful” piece.
   Create /api/suggestions/latest?domain=...
   Generate suggestions per run and store in seo_suggestions.

Example suggestion rules (minimum set):

* Authority/Backlinks

  * If DA/authority below a threshold or declining -> suggest backlink campaign + internal linking plan
  * If high toxic links -> suggest disavow review list
* Technical SEO

  * If missing titles/H1/duplicate meta -> suggest fixes with URL lists
  * If canonical/noindex issues -> suggest priority fixes
* SERP/Keywords

  * If many keywords in positions 11–20 -> suggest content refresh + on-page optimization pages list
  * If keyword cannibalization detected -> suggest consolidation plan
* Content Quality

  * If validator flags thin/duplicate content -> suggest rewrite targets
* Content Decay

  * If pages losing clicks/impressions -> suggest refresh schedule
* Competitive intel

  * If competitor outranks on specific terms -> suggest content gap pages + outline

Each suggestion must include:

* title
* severity (low/med/high)
* impacted urls/keywords
* evidence (metrics)
* recommended actions list (concrete steps)

6. Knowledge Base Insights: make this real
   Right now it’s empty/placeholder. Implement:

* /api/kbase/insights/latest?domain=...
* Generate “insights” by summarizing the top suggestions + recurring issues into short KBase articles.
* If KBase write is enabled, automatically write/update articles:

  * “Weekly SEO Summary”
  * “Top Technical Issues”
  * “Top Keyword Opportunities”
  * “Content Decay Watchlist”
  * “Backlink/Authority Notes”
* UI should show latest 3–5 insights with links to view full text.

7. Tickets: wire to real data and actions
   Implement diagnostic tickets as stored entities generated from rules:

* Each ticket includes owner (SEO, Content, Engineering), impact, priority, and evidence.
* Clicking a ticket opens detail view with:

  * evidence + affected URLs
  * recommended fix steps
  * “Mark resolved” / “Dismiss” actions that update status in DB
    No placeholders.

8. Page-level drilldowns must work
   For each left-nav section:

* Dashboard: reads from /api/latest + /api/suggestions/latest + /api/tickets/latest
* Sites: show list of site pages from crawler with filters (indexable, errors, content score, decay)
* Analysis: show combined insights with tabs per category
* SERP Tracking: show top 100 keywords table + click-through to keyword detail
* Web Authority: show authority/backlink trend and link counts (real)
* Integrations: show live status + last run time per worker
* Crew Manifest: show current crew list (already working)
* Suggested Changes: list from seo_suggestions
* Settings: domain + run settings

9. Reliability and performance

* Add caching for latest results per domain (short TTL) but always allow refresh by running /api/run.
* Make all worker calls time out safely and store error status per worker; UI shows partial results rather than breaking.
* Add server logs to see which worker failed and why.

Acceptance Criteria

* No card shows placeholder numbers (0, 25, 20) unless they are real computed values.
* “Get more data” triggers a run, updates stored results, and the UI refreshes with new values.
* Keyword Ranking tracks and displays up to 100 keywords.
* Technical SEO shows “Checked X of Y pages” where Y is total known site pages.
* Suggested Changes list appears on Dashboard and Suggested Changes page, generated from combined worker signals, with evidence and actions.
* Knowledge Base Insights shows 3–5 real insights and can write/read KBase if enabled.
* Industry benchmark section never shows Avg Position 0.0; shows valid values or N/A.
